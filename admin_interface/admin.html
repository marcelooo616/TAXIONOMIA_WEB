<!DOCTYPE html>
<html lang="pt-BR" data-theme="light">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Painel Admin Multi-Dataset</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./assets/style.css">
    <link rel="stylesheet" href="./assets/email-editor.css">
    <script src="./assets/theme.js"></script>
</head>

<body>
    <div id="loadingOverlay" class="hidden">
        <div class="loading-content">
            <div class="spinner"></div>
            <div id="loadingMessage">Processando...</div>
        </div>
    </div>

    <div class="app-container">
        <aside class="app-sidebar">
            <div class="sidebar-header">
                <svg width="32" height="32" viewBox="0 0 256 256" fill="currentColor">
                    <path
                        d="M128,80C48,80,16,80,16,80V56c0-26.5,50.1-48,112-48S240,29.5,240,56V80C240,80,208,80,128,80ZM16,108.3V136c0,26.5,50.1,48,112,48s112-21.5,112-48V108.3c-15.6,12.3-56.1,23.7-112,23.7S31.6,120.6,16,108.3ZM16,164.3V192c0,26.5,50.1,48,112,48s112-21.5,112-48V164.3c-15.6,12.3-56.1,23.7-112,23.7S31.6,176.6,16,164.3Z">
                    </path>
                </svg>
                <span>Admin Panel</span>
            </div>

            <nav class="sidebar-nav">
                <button class="nav-item active" data-view="data">
                    <svg width="20" height="20" viewBox="0 0 256 256" fill="currentColor">
                        <path
                            d="M216,40H40A16,16,0,0,0,24,56V200a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V56A16,16,0,0,0,216,40Zm0,160H40V56H216V200ZM176,88a48,48,0,0,1-96,0,8,8,0,0,1,16,0,32,32,0,0,0,64,0,8,8,0,0,1,16,0Z">
                        </path>
                    </svg>
                    Dados & Tabelas
                </button>
                <button class="nav-item" data-view="emails">
                    <svg width="20" height="20" viewBox="0 0 256 256" fill="currentColor">
                        <path
                            d="M224,48H32a8,8,0,0,0-8,8V192a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V56A8,8,0,0,0,224,48ZM203.4,64,128,135.6,52.6,64ZM216,192H40V80.4l82.6,78.6a8,8,0,0,0,10.9,0L216,80.4Z">
                        </path>
                    </svg>
                    Editor de E-mails
                </button>
            </nav>

            <div class="sidebar-footer">
                <button id="theme-toggle" class="icon-btn">
                </button>
            </div>
        </aside>

        <main class="app-content">

            <div id="view-data" class="view-section active">
                <section class="card fade-in" id="uploadBox">
                    <div class="upload-area-large">
                        <label for="fileInput" class="custom-file-upload large">
                            <span>Carregar Arquivo (JS / HTML)</span>
                            <small>Carregue dados e templates de e-mail</small>
                        </label>
                        <input id="fileInput" type="file" accept=".html,.js,text/html,text/javascript" />
                    </div>
                </section>

                <section class="card fade-in hidden" id="editorBox">
                    <div class="card-header row-between">
                        <div class="dataset-selector-area">
                            <label for="datasetSelect" class="subtitle">Editando Tabela:</label>
                            <select id="datasetSelect" class="custom-select"></select>
                        </div>
                        <div class="actions-group">
                            <button id="btnAddRow" class="btn btn-primary">Novo</button>
                            <button id="btnExport" class="btn btn-outline">Exportar Tudo</button>
                        </div>
                    </div>
                    <div class="search-bar">
                        <input type="text" id="searchInput" placeholder="Buscar..." />
                        <button id="btnResetFilters" class="btn-reset">Limpar</button>
                    </div>
                    <div id="filtersContainer" class="filters-grid hidden"></div>
                    <div class="table-responsive" id="tableContainer"></div>
                    <div id="paginationContainer" class="pagination-area hidden">
                        <div class="pagination-left">
                            <span id="pageInfo" class="page-info"></span>
                            <select id="rowsPerPageSelect" class="rows-select">
                                <option value="20">20 por página</option>
                                <option value="50">50 por página</option>
                                <option value="ALL">Mostrar Tudo</option>
                            </select>
                        </div>
                        <div class="pagination-controls">
                            <button id="btnPrevPage" class="btn btn-outline small">Anterior</button>
                            <button id="btnNextPage" class="btn btn-outline small">Próxima</button>
                        </div>
                    </div>
                    <div class="card-footer"><span id="filterStatus"></span></div>
                </section>
            </div>

            <div id="view-emails" class="view-section hidden">
                <div class="email-layout">
                    <div class="email-sidebar-list card">
                        <div class="list-header">
                            <h3>Modelos</h3>
                            <button id="btnNewEmail" class="btn-icon-small" title="Novo Modelo">+</button>
                        </div>
                        <div id="emailListContainer" class="email-list-scroll">
                        </div>
                    </div>

                    <div class="email-editor-area card">
                        <div class="editor-header">
                            <input type="text" id="emailName" placeholder="Nome do Modelo (ex: Strike 3)"
                                class="input-title">
                            <div class="actions">
                                <button id="btnViewSource" class="btn btn-ghost small">Ver HTML</button>
                                <button id="btnSaveEmail" class="btn btn-primary small">Salvar Alterações</button>
                            </div>
                        </div>

                        <div class="editor-meta">
                            <label>Assunto:</label>
                            <input type="text" id="emailSubject" class="input-subject"
                                placeholder="Assunto do e-mail...">
                        </div>

                        <div class="rich-toolbar">
                            <select id="varSelect" class="toolbar-select">
                                <option value="">Inserir Variável...</option>
                                <option value="${nomeCliente}">Nome Cliente</option>
                                <option value="${nomeAtendente}">Nome Atendente</option>
                                <option value="${numeroProtocolo}">Protocolo</option>
                            </select>
                            <div class="separator"></div>
                            <button class="tool-btn" data-cmd="bold" title="Negrito"><b>B</b></button>
                            <button class="tool-btn" data-cmd="italic" title="Itálico"><i>I</i></button>
                            <button class="tool-btn" data-cmd="underline" title="Sublinhado"><u>U</u></button>
                            <div class="separator"></div>
                            <button class="tool-btn" data-cmd="justifyLeft">Esq</button>
                            <button class="tool-btn" data-cmd="justifyCenter">Cen</button>
                            <div class="separator"></div>
                            <button class="tool-btn" data-cmd="insertUnorderedList">Lista</button>
                            <input type="color" id="colorPicker" title="Cor do Texto">
                        </div>

                        <div id="visualEditor" class="visual-editor" contenteditable="true">
                            <p>Selecione ou crie um modelo...</p>
                        </div>

                        <textarea id="codeEditor" class="code-editor hidden"></textarea>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <dialog id="editModal" class="custom-dialog">
        <div class="dialog-header">
            <h3 id="modalTitle">Editar</h3>
            <button id="btnCloseModal" class="btn-close-icon">X</button>
        </div>
        <div class="dialog-body">
            <form id="editForm"></form>
        </div>
        <div class="dialog-footer">
            <button id="btnCancelModal" class="btn btn-outline">Cancelar</button>
            <button id="btnSaveModal" class="btn btn-primary">Salvar</button>
        </div>
    </dialog>

    <script src="./assets/toast.js"></script>
    <script src="./assets/admin.js" defer></script>


    <script src="./assets/admin.js"></script>

    <script src="./assets/email-editor.js"></script>
</body>

</html>